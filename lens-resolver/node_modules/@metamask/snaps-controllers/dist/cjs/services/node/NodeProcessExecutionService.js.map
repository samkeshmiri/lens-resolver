{"version":3,"sources":["../../../../src/services/node/NodeProcessExecutionService.ts"],"sourcesContent":["import type { BasePostMessageStream } from '@metamask/post-message-stream';\nimport { ProcessParentMessageStream } from '@metamask/post-message-stream';\nimport type { ChildProcess } from 'child_process';\nimport { fork } from 'child_process';\n\nimport type { Job } from '..';\nimport { AbstractExecutionService } from '..';\n\nexport class NodeProcessExecutionService extends AbstractExecutionService<ChildProcess> {\n  protected async initEnvStream(): Promise<{\n    worker: ChildProcess;\n    stream: BasePostMessageStream;\n  }> {\n    const worker = fork(\n      require.resolve(\n        '@metamask/snaps-execution-environments/dist/browserify/node-process/bundle.js',\n      ),\n    );\n\n    const stream = new ProcessParentMessageStream({ process: worker });\n    return Promise.resolve({ worker, stream });\n  }\n\n  protected terminateJob(jobWrapper: Job<ChildProcess>): void {\n    jobWrapper.worker.kill();\n  }\n}\n"],"names":["NodeProcessExecutionService","AbstractExecutionService","initEnvStream","worker","fork","require","resolve","stream","ProcessParentMessageStream","process","Promise","terminateJob","jobWrapper","kill"],"mappings":";;;;+BAQaA;;;eAAAA;;;mCAP8B;+BAEtB;kBAGoB;AAElC,MAAMA,oCAAoCC,0BAAwB;IACvE,MAAgBC,gBAGb;QACD,MAAMC,SAASC,IAAAA,mBAAI,EACjBC,QAAQC,OAAO,CACb;QAIJ,MAAMC,SAAS,IAAIC,6CAA0B,CAAC;YAAEC,SAASN;QAAO;QAChE,OAAOO,QAAQJ,OAAO,CAAC;YAAEH;YAAQI;QAAO;IAC1C;IAEUI,aAAaC,UAA6B,EAAQ;QAC1DA,WAAWT,MAAM,CAACU,IAAI;IACxB;AACF"}